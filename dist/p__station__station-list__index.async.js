"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[740],{45689:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var r=n(90228),a=n.n(r),i=n(26068),o=n.n(i),s=n(87999),c=n.n(s),u=n(48305),l=n.n(u),d=n(23299),p=n(86743),f=n(17023),h=n(16621),m=n(50716),x=n(51273),v=n(61433),y=n(10511),w=n(62410),g=n(29223),k=n(1413),j=n(52089),S=n(14362),C=n(98953),Z=n(75271),b=n(95236),T=n(62198),_=n(37886),N=n(21193),P=n(61904),E={"station-form":"station-form___GgowF","ant-drawer-body":"ant-drawer-body___Zpqb1","ant-form-item":"ant-form-item___B9Nwv","ant-form-item-label":"ant-form-item-label___9EjYe","ant-input":"ant-input___oTRq0","ant-select-selector":"ant-select-selector___hg2ay","ant-select-focused":"ant-select-focused___wmLtS","form-footer":"form-footer___b4ghF"},q=n(52676),F={stationType:0,stationName:"aaaa",identificationName:"aaaa",receiverType:"CHC P5U",dataType:1,highAngle:5,antennaType:"CHCC220GR       CHCD",antennaHigh:0,coordType:0,coordContent:{referenceTime:null,velocityEnable:0,coord1:"-2489141.7000",coord2:"4798067.6650",coord3:"3374564.8910"},netMode:1,netType:0,netProtocols:[{ip:"stream.wegnss.com",port:"8999",encryptType:"NONE",user:"chcnav",pwd:"chcnac",source:"AHAL"}],coLocatedEnabled:0},I=function(e){var t=e.visible,n=e.onClose,r=e.onSubmit,i=e.initialValues,s=e.isEdit,u=void 0!==s&&s,d=N.Z.useForm(),p=l()(d,1)[0];(0,Z.useEffect)((function(){t&&(u&&i?p.setFieldsValue(i):p.resetFields())}),[t,u,i,p]);var f=function(){var e=c()(a()().mark((function e(){var t,n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.validateFields();case 3:return t=e.sent,n=o()(o()({},F),{},{stationName:t.stationName,identificationName:t.identificationName}),e.next=7,r(n);case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),h=function(){p.resetFields(),n()};return(0,q.jsx)(P.Z,{title:u?"编辑测站":"新增测站",width:600,onClose:h,open:t,className:E.stationForm,footer:(0,q.jsx)("div",{style:{textAlign:"right"},children:(0,q.jsxs)(k.Z,{children:[(0,q.jsx)(j.ZP,{onClick:h,children:"取消"}),(0,q.jsx)(j.ZP,{type:"primary",onClick:f,children:u?"保存":"创建"})]})}),children:(0,q.jsxs)(N.Z,{form:p,layout:"vertical",name:"stationForm",initialValues:{status:"stopped",network:"offline"},children:[(0,q.jsx)(N.Z.Item,{name:"stationName",label:"基站名称",rules:[{required:!0,message:"请输入基站名称"},{max:50,message:"基站名称不能超过50个字符"}],children:(0,q.jsx)(C.Z,{placeholder:"请输入基站名称"})}),(0,q.jsx)(N.Z.Item,{name:"identificationName",label:"标识名",rules:[{required:!0,message:"请输入标识名"},{max:50,message:"标识名不能超过50个字符"}],children:(0,q.jsx)(C.Z,{placeholder:"请输入标识名"})})]})})},z=T.Z.StationController,R=z.getStationList,H=z.addStation,L=z.editStation,O=z.deleteStation,U=function(){var e=(0,Z.useRef)(),t=(0,Z.useState)([]),n=l()(t,2),r=n[0],i=n[1],s=(0,Z.useState)(""),u=l()(s,2),T=u[0],N=u[1],P=(0,Z.useState)(!1),E=l()(P,2),F=E[0],z=E[1],U=(0,Z.useState)(void 0),V=l()(U,2),A=V[0],G=V[1],B=(0,Z.useState)(!1),D=l()(B,2),J=D[0],K=D[1],M=function(t){var n;N(t),null===(n=e.current)||void 0===n||n.reload()},Q=function(){var e=c()(a()().mark((function e(t){var n,r,i,s,c,u;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.current,r=void 0===n?1:n,i=t.pageSize,s=void 0===i?10:i,c=o()({page:Number(r),size:Number(s)},T&&{stationName:T}),e.next=4,R(c);case 4:return u=e.sent,e.abrupt("return",{data:u.records,total:u.total,success:!0});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var t=c()(a()().mark((function t(n){var r,i;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O({ids:[Number(n.id)]});case 2:"SUCCESS"===(null==(r=t.sent)?void 0:r.code)&&(_.yw.success("删除成功"),null===(i=e.current)||void 0===i||i.reload());case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Y=function(){var t=c()(a()().mark((function t(){var n;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:_.yw.loading("正在删除...",.5),_.yw.success("成功删除 ".concat(r.length," 个测站")),i([]),null===(n=e.current)||void 0===n||n.reload();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),X=function(){G(void 0),K(!1),z(!0)},$=function(){_.yw.info("导入测站数据")},ee=function(){var t=c()(a()().mark((function t(n){var r,i,o,s;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=J&&(null==A?void 0:A.id),i=r?L(A.id,n):H(n),t.next=4,i;case 4:"SUCCESS"===(null==(o=t.sent)?void 0:o.code)&&(_.yw.success(r?"编辑成功":"新增成功"),null===(s=e.current)||void 0===s||s.reload());case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),te=[{title:"基站名称",dataIndex:"stationName",key:"stationName",width:120,render:function(e,t){return(0,q.jsx)("a",{className:"station-name",children:t.stationName})}},{title:"标识名",dataIndex:"identificationName",key:"identificationName",width:150},{title:"接收机类型",dataIndex:"receiverType",key:"receiverType",width:150},{title:"数据类型",dataIndex:"dataType",key:"dataType",width:100},{title:"运行状态",dataIndex:"status",key:"status",width:100,render:function(e,t){return n=t.status,r=b.UO[n]||{color:"default",text:"未知"},(0,q.jsx)(w.Z,{color:r.color,children:r.text});var n,r}},{title:"网络",dataIndex:"network",key:"network",width:80,render:function(e,t){return n=t.network,r=b.mF[n]||{status:"default",text:"未知"},(0,q.jsx)(g.Z,{status:r.status,text:r.text});var n,r}},{title:"历元时间",dataIndex:"epochTime",key:"epochTime",width:160},{title:"操作",key:"action",width:120,fixed:"right",render:function(e,t){return(0,q.jsxs)(k.Z,{size:"small",children:[(0,q.jsx)(j.ZP,{type:"link",size:"small",icon:(0,q.jsx)(d.Z,{}),onClick:function(){return function(e){G(e),K(!0),z(!0)}(t)},children:"编辑"}),(0,q.jsx)(S.Z,{title:"确定要删除这个测站吗？",onConfirm:function(){return W(t)},okText:"确定",cancelText:"取消",children:(0,q.jsx)(j.ZP,{type:"link",size:"small",danger:!0,icon:(0,q.jsx)(p.Z,{}),children:"删除"})})]})}}];return(0,q.jsx)("div",{className:"station-list",children:(0,q.jsxs)(x._z,{header:{title:!1},breadcrumb:{},children:[(0,q.jsx)(v.Z,{headerTitle:"",actionRef:e,rowKey:"id",search:!1,toolBarRender:function(){return[(0,q.jsxs)(k.Z,{children:[(0,q.jsx)(C.Z.Search,{placeholder:"请输入基站名称",prefix:(0,q.jsx)(f.Z,{}),value:T,onChange:function(e){return N(e.target.value)},onSearch:M,style:{width:300},allowClear:!0,enterButton:"搜索"}),(0,q.jsx)(j.ZP,{type:"primary",icon:(0,q.jsx)(h.Z,{}),onClick:X,children:"新增"}),(0,q.jsx)(j.ZP,{icon:(0,q.jsx)(m.Z,{}),onClick:$,children:"导入"})]},"toolbar")]},request:Q,columns:te,rowSelection:{onChange:function(e,t){return i(t)}},pagination:{defaultPageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:function(e,t){return"第 ".concat(t[0],"-").concat(t[1]," 条/总共 ").concat(e," 条数据")}},scroll:{x:1200},size:"middle"}),(null==r?void 0:r.length)>0&&(0,q.jsx)(y.S,{extra:(0,q.jsxs)("div",{children:["已选择 ",(0,q.jsx)("a",{style:{fontWeight:600},children:r.length})," 项  "]}),children:(0,q.jsx)(S.Z,{title:"确定要删除选中的 ".concat(r.length," 个测站吗？"),onConfirm:Y,okText:"确定",cancelText:"取消",children:(0,q.jsx)(j.ZP,{danger:!0,children:"批量删除"})})}),(0,q.jsx)(I,{visible:F,onClose:function(){z(!1),G(void 0),K(!1)},onSubmit:ee,initialValues:A,isEdit:J})]})})}},62198:function(e,t,n){n.d(t,{Z:function(){return C}});var r={};n.r(r),n.d(r,{login:function(){return l}});var a={};n.r(a),n.d(a,{addStation:function(){return y},deleteStation:function(){return j},editStation:function(){return g},getStationDynamicInfo:function(){return x},getStationList:function(){return h}});var i=n(90228),o=n.n(i),s=n(87999),c=n.n(s),u=n(20110);function l(e,t){return d.apply(this,arguments)}function d(){return(d=c()(o()().mark((function e(t,n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/app/login",{method:"POST",headers:{"Validate-Code-Token":n},data:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var p=n(26068),f=n.n(p);function h(e){return m.apply(this,arguments)}function m(){return(m=c()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/stream/stations",{method:"GET",params:f()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return v.apply(this,arguments)}function v(){return(v=c()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/stream/stations/dynamic-info/simple",{method:"GET",getResponse:!0}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=c()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/stream/stations",{method:"POST",data:f()({},t),getResponse:!0}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t){return k.apply(this,arguments)}function k(){return(k=c()(o()().mark((function e(t,n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/stream/stations/".concat(t),{method:"PUT",data:f()({},n),getResponse:!0}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return S.apply(this,arguments)}function S(){return(S=c()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/stream/stations/delete",{method:"POST",data:f()({},t),skipErrorHandler:!0,getResponse:!0}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C={LoginController:r,StationController:a}}}]);